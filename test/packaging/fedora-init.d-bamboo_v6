#!/bin/bash
#
#       /etc/init.d/bamboo_v6
#
# Starts the bamboo_v6 daemon
#

# Source function library.
. /etc/rc.d/init.d/functions

RETVAL=0
process_no=-1
check_previous=""

start() {
        # Check that we're a privileged user
        [ `id -u` = 0 ] || exit 4

        #Check if it is already running
        check_previous=`ps ax |grep -c "/bamboo_v6/bin/"`
        if [ $check_previous == 1 ]; then
                echo -n $"Starting bamboo_v6 daemon: "            
                daemon /home/bishaj/bamboo_v6/bin/run-java bamboo.lss.DustDevil /home/bishaj/gateway_v6.cfg 2>>/var/log/bamboo_v6 #3>>/var/log/bamboo_v6 1>>/var/log/bamboo_v6
                RETVAL=$?
        else
                echo -n $"Not starting, bamboo_v6 daemon is already running:"
        fi

        echo
        return $RETVAL
}

stop() {
        echo -n $"Stopping bamboo_v6 daemon: "
        process_no=`cat /var/run/bamboo_v6.pid`

        #kill the process
        kill -9 $process_no 2>/dev/null
        RETVAL=$?

	echo "" > /var/run/bamboo_v6.pid

        echo
        return $RETVAL
}

restart() {
        stop
        start
}

reload() {
        trap "" SIGHUP
        action $"Reloading bamboo_v6 daemon:" killall -HUP /home/bishaj/bamboo/bin/run-java
        RETVAL=$?
        return $RETVAL
}

case "$1" in
start)
        start
        ;;
stop)
        stop
        ;;
reload)
        #reload
        echo "$0: Unimplemented feature."
        RETVAL=4
        ;;
force-reload)
        echo "$0: Unimplemented feature."
        RETVAL=3
        ;;
restart)
        restart
        ;;
condrestart)
        #if [ -f /var/lock/subsys/acpid ]; then
        #    restart
        #fi
        echo "$0: Unimplemented feature."
        RETVAL=5
        ;;
status)
        #status acpid
        #RETVAL=$?
        echo "$0: Unimplemented feature."
        RETVAL=6
        ;;
*)
        echo $"Usage: $0 {start|stop|restart}"
        RETVAL=2
esac

exit $RETVAL

